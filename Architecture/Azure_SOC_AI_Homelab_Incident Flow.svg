<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="980" viewBox="0 0 1600 980">
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#111"/>
    </marker>
    <style>
      .box { fill: #fff; stroke: #111; stroke-width: 2; rx: 16; }
      .lane { fill: #fafafa; stroke: #bbb; stroke-width: 1.5; rx: 18; }
      .title { font-family: Arial, Helvetica, sans-serif; font-size: 18px; font-weight: 700; fill:#111; }
      .t { font-family: Arial, Helvetica, sans-serif; font-size: 15px; fill:#111; }
      .small { font-family: Arial, Helvetica, sans-serif; font-size: 13px; fill:#333; }
      .arrow { stroke:#111; stroke-width:2.2; fill:none; marker-end:url(#arrow); }
      .dash { stroke:#111; stroke-width:2.0; fill:none; stroke-dasharray:6 6; marker-end:url(#arrow); }
    </style>
  </defs>

  <!-- Header -->
  <text x="40" y="45" class="title">Azure SOC + AI-Enhanced Homelab — High-Level Detection &amp; Response Flow</text>
  
  <!-- Swimlanes -->
  <rect x="30" y="95" width="1540" height="200" class="lane"/>
  <text x="50" y="125" class="title">1) Initial Access &amp; Execution</text>

  <rect x="30" y="315" width="1540" height="220" class="lane"/>
  <text x="50" y="345" class="title">2) Telemetry Collection (Endpoint • Identity • Network • Email)</text>

  <rect x="30" y="555" width="1540" height="210" class="lane"/>
  <text x="50" y="585" class="title">3) SIEM Detection, Correlation &amp; Enrichment (Microsoft Sentinel)</text>

  <rect x="30" y="785" width="1540" height="170" class="lane"/>
  <text x="50" y="815" class="title">4) Response, DFIR &amp; Documentation</text>

  <!-- Lane 1 boxes -->
  <rect x="70" y="150" width="250" height="95" class="box"/>
  <text x="90" y="180" class="t">Phishing / BEC lure</text>
  <text x="90" y="205" class="small">Email with link/attachment</text>

  <rect x="370" y="150" width="250" height="95" class="box"/>
  <text x="390" y="180" class="t">User interaction</text>
  <text x="390" y="205" class="small">Click / open / macro</text>

  <rect x="670" y="150" width="250" height="95" class="box"/>
  <text x="690" y="180" class="t">Payload / credential theft</text>
  <text x="690" y="205" class="small">Malware exec, token theft</text>

  <rect x="970" y="150" width="250" height="95" class="box"/>
  <text x="990" y="180" class="t">Downstream activity</text>
  <text x="990" y="205" class="small">Lateral movement, exfil</text>

  <!-- Lane 2 boxes -->
  <rect x="70" y="385" width="320" height="110" class="box"/>
  <text x="90" y="415" class="t">Windows endpoints (Azure VMs)</text>
  <text x="90" y="440" class="small">Windows Event Logs + Sysmon</text>
  <text x="90" y="462" class="small">Defender for Endpoint signals</text>

  <rect x="430" y="385" width="320" height="110" class="box"/>
  <text x="450" y="415" class="t">Identity &amp; cloud audit</text>
  <text x="450" y="440" class="small">Entra ID sign-in logs</text>
  <text x="450" y="462" class="small">Cloud audit events</text>

  <rect x="790" y="385" width="320" height="110" class="box"/>
  <text x="810" y="415" class="t">Email security telemetry</text>
  <text x="810" y="440" class="small">Defender email signals</text>
  <text x="810" y="462" class="small">Phishing artifacts (URLs)</text>

  <rect x="1150" y="385" width="360" height="110" class="box"/>
  <text x="1170" y="415" class="t">Linux network sensor (Azure)</text>
  <text x="1170" y="440" class="small">Zeek + Suricata</text>
  <text x="1170" y="462" class="small">DNS/HTTP/TLS/flows alerts</text>

  <!-- Lane 3 boxes -->
  <rect x="70" y="625" width="330" height="110" class="box"/>
  <text x="90" y="655" class="t">Microsoft Sentinel ingest</text>
  <text x="90" y="680" class="small">Log Analytics workspace</text>
  <text x="90" y="702" class="small">Centralised logging</text>

  <rect x="430" y="625" width="330" height="110" class="box"/>
  <text x="450" y="655" class="t">Detections &amp; hunting</text>
  <text x="450" y="680" class="small">Analytics rules (KQL)</text>
  <text x="450" y="702" class="small">Cross-signal correlation</text>

  <rect x="790" y="625" width="350" height="110" class="box"/>
  <text x="810" y="655" class="t">Alert enrichment</text>
  <text x="810" y="680" class="small">ANY.RUN interactive analysis</text>
  <text x="810" y="702" class="small">IOC + threat intel correlation</text>

  <rect x="1180" y="625" width="330" height="110" class="box"/>
  <text x="1200" y="655" class="t">SOAR automation</text>
  <text x="1200" y="680" class="small">Logic Apps playbooks</text>
  <text x="1200" y="702" class="small">Triage → actions → tickets</text>

  <!-- Lane 4 boxes -->
  <rect x="70" y="855" width="360" height="85" class="box"/>
  <text x="90" y="885" class="t">Containment &amp; remediation</text>
  <text x="90" y="910" class="small">Account disable, isolate host</text>

  <rect x="470" y="855" width="340" height="85" class="box"/>
  <text x="490" y="885" class="t">DFIR: Velociraptor</text>
  <text x="490" y="910" class="small">Artifacts, live hunts, collection</text>

  <rect x="850" y="855" width="360" height="85" class="box"/>
  <text x="870" y="885" class="t">Case file &amp; reporting</text>
  <text x="870" y="910" class="small">Markdown incident report (GitHub)</text>

  <rect x="1250" y="855" width="300" height="85" class="box"/>
  <text x="1270" y="885" class="t">Lessons learned</text>
  <text x="1270" y="910" class="small">ACSC Essential Eight mapping</text>

  <!-- Arrows Lane 1 -->
  <path class="arrow" d="M 320 197 L 370 197"/>
  <path class="arrow" d="M 620 197 L 670 197"/>
  <path class="arrow" d="M 920 197 L 970 197"/>

  <!-- Arrows from downstream to telemetry -->
  <path class="dash" d="M 1095 245 L 230 385"/>
  <path class="dash" d="M 1095 245 L 590 385"/>
  <path class="dash" d="M 1095 245 L 950 385"/>
  <path class="dash" d="M 1095 245 L 1325 385"/>

  <!-- Telemetry to Sentinel -->
  <path class="arrow" d="M 230 495 L 230 625"/>
  <path class="arrow" d="M 590 495 L 235 625"/>
  <path class="arrow" d="M 950 495 L 240 625"/>
  <path class="arrow" d="M 1325 495 L 255 625"/>

  <!-- Sentinel pipeline -->
  <path class="arrow" d="M 400 680 L 430 680"/>
  <path class="arrow" d="M 760 680 L 790 680"/>
  <path class="arrow" d="M 1140 680 L 1180 680"/>

  <!-- SOAR & enrichment to response -->
  <path class="arrow" d="M 1345 735 L 250 855"/>
  <path class="arrow" d="M 965 735 L 640 855"/>

  <!-- Response flow -->
  <path class="arrow" d="M 430 897 L 470 897"/>
  <path class="arrow" d="M 810 897 L 850 897"/>
  <path class="arrow" d="M 1210 897 L 1250 897"/>

</svg>
